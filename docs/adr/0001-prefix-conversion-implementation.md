# 0001-prefix-conversion-implementation

## タイトル
接頭辞変換機能の実装

## ステータス
承認済み (Accepted)

## コンテキスト
SKK入力システムにおいて、ユーザーが「だい>」のような形式で接頭辞を含む見出し語を効率的に検索・入力できる機能が不足していた。既存のSKKシステムでは、見出し語モードでの「>」入力が特別な意味を持たず、接頭辞検索に利用できなかった。

## 決定
見出し語モード（`MidashigoMode`）において、「>」が入力された際に、入力中の文字列に「>」を付加した形式（例：「だい>」）で辞書を検索し、候補を表示する機能を実装する。

具体的には、以下の変更を行った。
- `src/lib/skk/input-mode/henkan/MidashigoMode.ts` の `onSymbol` メソッドで「>」キーの処理を追加し、入力中の文字列に「>」を付加して辞書検索キーを生成するように拡張した。
- `src/lib/skk/input-mode/henkan/MidashigoMode.ts` の `createJisyoKey` メソッドで「>」を含む見出し語を適切に処理するように拡張した。
- `package.json` の `contributes.keybindings` セクションに「>」キーのキーバインドを追加し、`skk.symbolInput` コマンドにバインドした。条件は `editorTextFocus && skk.activeKey.greater` とした。
- 関連するユニットテストを `test/unit/lib/skk/input-mode/henkan/MidashigoMode.test.ts` に追加した。

## 結果
- ユーザーは `MidashigoMode` で「Dai>」のように入力することで、接頭辞を含む見出し語を検索し、変換候補として表示できるようになった。
- 既存の入力フローに大きな変更を加えることなく、新しい機能が追加された。
- 関連するユニットテストが追加され、機能の正確性が検証された。
- ユニットテストおよびインテグレーションテストが成功し、機能が期待通りに動作することを確認した。

## 代替案
- **別の記号を使用する**: 「>」以外の記号（例：「<」、「?」）を使用することも考えられた。しかし、DDSKKドキュメントでは「>」が主要な接頭辞/接尾辞モードの文字として扱われており、ほとんどのユーザーが「>」を使用している。また、設定で他の記号も利用可能ではあるものの、現時点では「<」と「?」のサポートは不要と判断されたため、「>」が最も適切であると決定された。
