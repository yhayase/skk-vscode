# skk-vscode プロジェクト概要

## 概要
skk-vscode は VSCode エディタ内で動作する日本語入力システム（SKK: Simple Kana to Kanji）の実装です。SKK は元々 Emacs 向けに開発された日本語入力方式で、このプロジェクトはその機能を VSCode 内で実現することを目的としています。

## 主な機能
1. **基本入力機能**
   - ローマ字入力からひらがな・カタカナへの変換
   - ひらがなから漢字への変換（見出し語変換）
   - 送り仮名付きの変換に対応
   - 変換候補の表示と選択（最初の3つはインライン表示、4つ目以降はメニュー表示）

2. **入力モード**
   - ひらがなモード (HiraganaMode)
   - カタカナモード (KatakanaMode)
   - 半角英数モード (AsciiMode)
   - 全角英数モード (ZeneiMode)
   - Abbrev モード（スラッシュ記号で英数字での見出し語検索）

3. **変換モード**
   - インライン変換モード (InlineHenkanMode)
   - メニュー変換モード (MenuHenkanMode)
   - 見出し語モード (MidashigoMode)
   - 確定モード (KakuteiMode)

4. **辞書システム**
   - 複数の辞書を検索可能
   - 設定で利用する辞書を指定可能
   - 郵便番号辞書なども利用可能

## プロジェクト構造
- **src/extension.ts**: 拡張機能のエントリーポイント
- **src/VSCodeEditor.ts**: VSCode エディタとの連携を担当
- **src/VSCodeJisyoProvider.ts**: VSCode 環境での辞書提供機能
- **src/lib/skk/**: SKK の中核機能
  - **input-mode/**: 各種入力モードの実装
  - **input-mode/henkan/**: 変換モードの実装
  - **jisyo/**: 辞書関連の実装
  - **editor/**: エディタ抽象化レイヤー

## 開発中の機能: 辞書登録機能
現在、辞書登録機能の実装が進行中です。この機能は以下の要素から構成されます：

1. **特徴**
   - ユーザが新しい「読み」と「単語」の組をユーザ辞書に登録可能
   - 独立した「モード」ではなく、複数の要素の組み合わせで実現

2. **実装方法**
   - 特定の形式に従ったテキストファイルを開くエディタタブ
   - InlineHenkanMode や MenuHenkanMode で候補の末尾より先に進んだときにエディタタブを開く
   - エディタから「読み」と「単語」を取り出してユーザ辞書に登録し、エディタを閉じる VSCode コマンド

3. **動作フロー**
   - 変換モードで候補がない場合や最後の候補より後に進もうとした場合に新しいエディタタブが開く
   - エディタタブには変換対象の「読み」が入力され、単語は空の状態
   - ユーザが「単語」を入力した後に登録コマンドを実行
   - 読みと単語の組がユーザ辞書に登録され、エディタタブが閉じられる
   - 登録前のエディタタブにフォーカスが戻る

## 現状と制限事項
- 現在のバージョンは 0.0.2
- DDSKK と同様の振る舞いを目指しているが、VSCode 拡張機能の制約により一部動作が異なる
- 変換候補のメニューは編集中の行の行頭に表示される
