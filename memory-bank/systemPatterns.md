# System Patterns

## システムアーキテクチャ
- SKK入力システムは、複数の入力モード（かな入力モード、変換モード、見出し語モードなど）を持つ状態機械として設計されています。
- 各モードは特定の入力処理を担当し、ユーザー入力に応じてモード間を遷移します。
- 主要なモードには、KakuteiMode（確定モード）、MidashigoMode（見出し語モード）、InlineHenkanMode（インライン変換モード）などがあります。

## 主要な技術的決定
- 接頭辞入力機能は、見出し語モードで「>」が入力された際に、「>」つきの見出し語を検索する処理を追加することで実装されています。
- 接尾辞入力機能は、InlineHenkanModeで候補が表示されている状態で「>」が入力された際に、現在の候補を確定させ、かな入力の見出し語モードに遷移し、「▽>」状態を表示することで実装されています。
- 既存のモード遷移ロジックを活用し、必要に応じて新しいモードや処理を追加するアプローチを採用しています。

## 使用中のデザインパターン
- 状態パターン：各入力モードを状態として表現し、状態間の遷移を管理することで、複雑な入力処理を整理しています。
- シングルトンパターン：一部のモード（例：AsciiMode、ZeneiMode）では、シングルトンインスタンスを使用して一貫した状態を保っています。

## コンポーネントの関係
- KakuteiMode：基本的なかな入力と確定処理を担当し、大文字入力でMidashigoModeに遷移します。
- MidashigoMode：見出し語の入力処理を担当し、接頭辞入力の処理が実装されています。
- InlineHenkanMode：変換候補の表示と確定処理を担当し、接尾辞入力のための「>」処理が実装されています。
- AbbrevMode：特定の記号（例：「/」）入力後の見出し語モードを担当します。

## 重要な実装パス
- 接頭辞入力：MidashigoModeまたは関連モードでの「>」入力処理を拡張し、辞書検索ロジックを調整する。
- 接尾辞入力：InlineHenkanModeの`onSymbol`メソッド内で「>」入力時の候補確定とモード遷移処理を追加する。
